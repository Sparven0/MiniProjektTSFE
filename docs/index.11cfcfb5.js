const e="http://localhost:3030/books";async function t(){let t=await fetch(e);if(!t.ok)throw Error("Network response was not ok");let o=await t.json();return o?console.log("Books array:",o):console.log("Books property is undefined or missing."),o}async function o(t,o){let n=`${e}/${t}/readstatus`,a={method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify({read:o})};try{let e=await fetch(n,a),t=await e.json();console.log(t)}catch(e){console.log("Error updating readstatus",e)}}async function n(t,o){let n=`${e}/${t}/reviewstatus`,a={method:"PATCH",headers:{"Content-type":"application/json"},body:JSON.stringify({review:`${o}`})};try{let e=await fetch(n,a);await e.json()}catch(e){console.log("Error updating status:",e)}}async function a(t,o,n,a){let r={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({ID:Date.now(),title:t,writer:o,read:n,review:""})};try{let t=`${e}/new`,o=await fetch(t,r),n=await o.json();console.log(n),a()}catch(e){console.log("Error writing book:",e)}}async function r(t,o){let n=`${e}/${t}/delete`;try{let e=await fetch(n,{method:"DELETE",headers:{"Content-type":"application/json"}}),t=await e.json();console.log(t),o()}catch(e){console.log("Error deleting book:",e)}}const i=document.querySelector("form");async function c(){try{let e=await t();console.log(e),e.books&&Array.isArray(e.books)?e.books.forEach(function(e){let t=document.createElement("div");t.classList.add("bookwrapper");let a=document.createElement("button");a.innerText="Save";let i=document.createElement("p"),l=document.createElement("p"),s=document.createElement("p"),d=document.createElement("input");s.innerText=`Read: ${e.read}`,d.setAttribute("type","checkbox"),d.checked=e.read,d.addEventListener("change",()=>{u.disabled=!d.checked;let e=d.checked;s.innerText=`Read: ${e?"true":"false"}`,e&&"disliked"===u.value?m():h()});let u=document.createElement("select");["no comment","liked","disliked"].forEach(e=>{let t=document.createElement("option");t.value=e,t.innerText=e,u.appendChild(t)}),u.value=e.review,u.disabled=!d.checked;let p="";function m(){if(!t.querySelector(".removeBtn")){let o=document.createElement("button");o.innerText="Remove",o.classList.add("removeBtn"),t.append(o),o.addEventListener("click",async()=>{await r(e.ID,c),location.reload()})}}function h(){let e=t.querySelector(".removeBtn");e&&e.remove()}u.addEventListener("change",()=>{p=u.value,"disliked"===p&&d.checked?m():h()}),l.innerText=`Writer: ${e.writer}`,i.innerText=`Title: ${e.title}`,document.body.append(t),t.append(i,l,d,u,a,s),e.read&&"disliked"===e.review&&m(),a.addEventListener("click",async()=>{console.log(e.ID);let t=d.checked;await o(e.ID,t),await n(e.ID,p),t&&"disliked"===u.value?m():h()})}):console.log("Data is not in the expected format or 'books' property is missing.")}catch(e){console.error("Error fetching data:",e)}}i?.addEventListener("submit",e=>{e.preventDefault();let t=new FormData(i),o=t.get("title"),n=t.get("writer"),r=t.get("read");location.reload(),a(o,n,null!==r&&"string"==typeof r&&"on"===r,()=>{c()})}),c();
//# sourceMappingURL=index.11cfcfb5.js.map
